<!DOCTYPE html>
<html lang="en" class="Individual-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Bound BBS Signatures</title>
<meta content="Vasilis Kalos" name="author">
<meta content="
       In the bound BBS Signatures scheme, the Signer of the BBS signature binds it to a BLS secret key holded by the Prover. Creating a valid BBS Proof from that signature, will require knowledge of that secret key. 
    " name="description">
<meta content="xml2rfc 3.17.1" name="generator">
<meta content="draft-bound-bbs-signatures-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.17.1
    Python 3.11.1
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.29.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-bound-bbs-signatures.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">Bound BBS Signatures</td>
<td class="right">April 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kalos</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">none</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-04-30" class="published">30 April 2023</time>
    </dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">V. Kalos</div>
<div class="org">MATTR</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Bound BBS Signatures</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">In the bound BBS Signatures scheme, the Signer of the BBS signature binds it to a BLS secret key holded by the Prover. Creating a valid BBS Proof from that signature, will require knowledge of that secret key.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-bbs-operations" class="internal xref">BBS operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-bbs-and-bls-ciphersuites" class="internal xref">BBS and BLS Ciphersuites</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-provers-set-up" class="internal xref">Prover's Set Up</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-bls-keys-generation" class="internal xref">BLS keys generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-bls-secret-key-commitment" class="internal xref">BLS secret key commitment</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-core-operations" class="internal xref">Core Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-signature-generation" class="internal xref">Signature Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-bls-key-pop-verification" class="internal xref">BLS Key PoP Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-signature-issuance" class="internal xref">Signature Issuance</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-signature-verification" class="internal xref">Signature Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-proof-generation" class="internal xref">Proof Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-proof-verification" class="internal xref">Proof Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-utility-operations" class="internal xref">Utility Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-getblspopmsg" class="internal xref">GetBlsPopMsg</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-create-generators" class="internal xref">Create Generators</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-subgroup-checks" class="internal xref">Subgroup Checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-key-pop-domain-separation" class="internal xref">Key PoP Domain Separation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-key-pop-uniqueness" class="internal xref">Key PoP Uniqueness</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Creating a BBS signature bound to a Prover's secret, follows a very similar flow and procedure as then normal BBS Signature and Proof generation and verification flow. The main deference is that the Prover is required to supply a BLS public key, together with a proof of possession (KeyPoP) of the corresponding secret key, prior to issuance of the bound BBS signature. The flow for issuing and using a bound BBS signature can be seen bellow.<a href="#section-1-1" class="pilcrow">¶</a></p>
<span id="name-basic-diagram-capturing-the"></span><figure id="figure-1">
        <div class="lang-ascii-art sourcecode" id="section-1-2.1">
<pre>(3) BoundSign                           (1) BlsKeyPoP
   +-----                                   +-----
   |    |                                   |    |
   |    |                                   |    |
   |   \ /                                  |   \ /
+----------+                             +-----------+
|          |                             |           |
|          |                             |           |
|          |&lt;----(2) send PK, KeyPoP-----|           |---+
|  Signer  |                             |  Holder/  |   | (5) BoundProofGen
|          |--(4) Send signature + msgs-&gt;|  Prover   |&lt;--|
|          |                             |           |
|          |                             |           |
+----------+                             +-----------+
                                               |
                                               |
                                               |
                                 (6) Send proof + disclosed msgs
                                               |
                                               |
                                              \ /
                                         +-----------+
                                         |           |
                                         |           |
                                         |           |
                                         | Verifier  |
                                         |           |
                                         |           |
                                         |           |
                                         +-----------+
                                            |   / \
                                            |    |
                                            |    |
                                            +-----
                                    (7) BoundProofVerify


</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-basic-diagram-capturing-the" class="selfRef">Basic diagram capturing the main entities involved in using the scheme</a>
        </figcaption></figure>
<div id="notation">
<section id="section-1.1">
        <h3 id="name-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-1.1-1.1">BP_1
: The base point of the G1 subgroup.<a href="#section-1.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.1-1.2">list.push(element)
: push an element, to the end of a list.<a href="#section-1.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.1-1.3">BlsSign, BlsVerify
: BLS Signatures Sign and Verify operations, in "message augmentation" mode, as described in Section 3.2.1 of <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span>.<a href="#section-1.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="bbs-operations">
<section id="section-1.2">
        <h3 id="name-bbs-operations">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-bbs-operations" class="section-name selfRef">BBS operations</a>
        </h3>
<p id="section-1.2-1">This document makes use of various operations defined in the BBS draft <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span>. Note that the Core BBS operations used (i.e., BbsVerify, BbsProofGen and BbsProofVerify) are using the create_generators procedure defined in this document in <a href="#create-generators">Create Generators</a>, instead of the one defined in the BBS document (which we wil denote as core_create_generators here). More specifically,<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-1.2-2.1">core_create_generators := create_generators as defined in <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html#name-generator-point-computation">Section 4.2</a> in <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span><a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.2">BbsVerify := Verify as defined in <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html#name-verify">Section 3.4.2</a> in <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span>, using the create_generators procedure as defined in <a href="#create-generators">Create Generators</a>.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.3">BbsProofGen := ProofGen as defined in <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html#name-proofgen">Section 3.4.3</a> in <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span>, using the create_generators procedure as defined in <a href="#create-generators">Create Generators</a>.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.4">BbsProofVerify := ProofVerify as defined in <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html#name-proofverify">Section 3.4.4</a> in <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span>, using the create_generators procedure as defined in <a href="#create-generators">Create Generators</a>.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="bbs-and-bls-ciphersuites">
<section id="section-1.3">
        <h3 id="name-bbs-and-bls-ciphersuites">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-bbs-and-bls-ciphersuites" class="section-name selfRef">BBS and BLS Ciphersuites</a>
        </h3>
<p id="section-1.3-1">This document requires the use of both a BBS and a BLS ciphersuite. Those ciphersuites MUST be based on the same curves (i.e., BLS12-381, BN etc). Additionally, the BLS ciphersuite, MUST use a "message augmentation" ciphersuite, with "minimal-pubkey-size". As an example of a BBS and BLS suites that can be used together are the following:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3-2">
<pre>BBS Suite: "BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_"
BLS Suite: "BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_AUG_"
</pre><a href="#section-1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-1.3-3">The BBS Signer MUST validate that the correct BLS ciphersuite is used. This is done by performing the necessary subgroup checks (see the <a href="#subgroup-checks">Subgroup Checks</a> section).<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="prover-s-set-up">
<section id="section-2">
      <h2 id="name-provers-set-up">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-provers-set-up" class="section-name selfRef">Prover's Set Up</a>
      </h2>
<p id="section-2-1">The prover must create a BLS secret/public key pair and supply proof of possessing (PoP) the BLS secret key, as well as that the public key is well formed. This is achieved by creating a BLS signature, using that secret key, and sending that signature to the Issuer.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The BLS suite used MUST be based to the same curves as the BBS suite (i.e., BLS12-381). The BLS suite MUST also use a signature variant for minimum public key size (SV: minimal-pubkey-size).<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="bls-keys-generation">
<section id="section-2.1">
        <h3 id="name-bls-keys-generation">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-bls-keys-generation" class="section-name selfRef">BLS keys generation</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-2.1-1">
<pre>BlsSk = Bls_KeyGen(IKM)
BlsPk = BlsSkToPk(SK)
</pre><a href="#section-2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bls-secret-key-commitment">
<section id="section-2.2">
        <h3 id="name-bls-secret-key-commitment">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-bls-secret-key-commitment" class="section-name selfRef">BLS secret key commitment</a>
        </h3>
<p id="section-2.2-1">The BlsKeyPoP operation is used by the Prover to generate a proof of possession of their BLS secret key. The commitment is essentially a BLS signature to a predefined message. NOTE: The BlsSign bellow is NOT BLS core sign, but rather the "message augmentation" Sign. See the <a href="#notation">Notation</a> section.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The BLS signature is calculated over a message including both the BBS and BLS ciphersuites, an audience identifier (i.e., the BBS Signer's ID), a domain separation tag (dst) and any extra information the application may require to be bound to a proof (like a BBS Signer's supplied nonce, a creation date etc.).<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Although the dst is optional, it is RECOMMENDED that it will include at least the application's name together with a version number.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-4">
<pre>KeyPoP = BlsKeyPoP(BlsSk, aud, extra_info, dst)

Inputs:

- BlsSk (REQUIRED), octet string. The BLS secret key
- aud (REQUIRED), octet string. The Issuer's unique identifier.
- dst (OPTIONAL), octet string. Domain separation tag. If not supplied
                  it defaults to the empty string ("").
- extra_info (OPTIONAL), octet string. Extra information to bind to a
                         KeyPoP (e.g., creation date, dst etc.). If not
                         supplied, it defaults to the empty string ("").

Parameters:

- bbs_suite_id, ASCII string. The unique ID of the BBS ciphersuite.
- bls_suite_id, ASCII string. The unique ID of the BLS ciphersuite.

Outputs:

- KeyPoP, octet string. A BLS signature, representing the commitment
                to the secret key.

Procedure:

1. msg = get_bls_pop_msg(bbs_suite_id, bls_suite_id, aud, dst, extra_info)
2. if msg is INVALID, return INVALID
3. Bls_Signature = BlsSign(BlsSk, msg)
4. return Bls_Signature
</pre><a href="#section-2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="core-operations">
<section id="section-3">
      <h2 id="name-core-operations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-core-operations" class="section-name selfRef">Core Operations</a>
      </h2>
<div id="signature-generation">
<section id="section-3.1">
        <h3 id="name-signature-generation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-signature-generation" class="section-name selfRef">Signature Generation</a>
        </h3>
<p id="section-3.1-1">A bound BBS signature issuance consists of 2 steps. First, the public key and PoP supplied by the prover are validated. Then, that PK is used to generate the BBS signature. Both operations are further explained bellow,<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="bls-key-pop-verification">
<section id="section-3.1.1">
          <h4 id="name-bls-key-pop-verification">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-bls-key-pop-verification" class="section-name selfRef">BLS Key PoP Verification</a>
          </h4>
<p id="section-3.1.1-1">The BlsKeyPopVerify operation validates a proof of possession of a BLS secret key (KeyPoP) created using the <a href="#bls-secret-key-commitment">BlsKeyPoP</a> operation. It is used from the Signer to validate the KeyPoP supplied by the Prover, against the Prover's BLS public key. This operation MUST at all times proceed the Bound BBS signature generation procedure. The signer MUST NOT create a bound BBS signature if the BlsKeyPopVerify operation does not return VALID first.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.1-2">
<pre>result = BlsKeyPopVerify(KeyPoP, BlsPk, aud, dst, extra_info)

Inputs

- KeyPoP (REQUIRED), octet string. The key commitment outputted
                            from the BlsKeyPoP operation.
- BlsPk (REQUIRED), octet string. The Prover's BLS public key.
- aud (REQUIRED), octet string. The Issuer's unique identifier.
- dst (OPTIONAL), octet string. Domain separation tag. If not supplied
                  it defaults to the empty string ("").
- extra_info (OPTIONAL), octet string. Extra information bound to the
                         KeyPoP (e.g., creation date etc.). If not
                         supplied it defaults to the empty string ("").

Parameters:

- bbs_suite_id, ASCII string. The unique ID of the BBS ciphersuite.
- bls_suite_id, ASCII string. The unique ID of the BLS ciphersuite.

Procedure:

1. res = KeyValidate(BlsPk)
2. if res INVALID, return INVALID

3. msg = get_bls_pop_msg(bbs_suite_id, bls_suite_id, aud, dst, extra_info)
4. if msg is INVALID, return INVALID

5. res = BlsVerify(BlsPk, msg, KeyPoP)
6. if res is INVALID, return INVALID

7. return VALID
</pre><a href="#section-3.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-issuance">
<section id="section-3.1.2">
          <h4 id="name-signature-issuance">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-signature-issuance" class="section-name selfRef">Signature Issuance</a>
          </h4>
<p id="section-3.1.2-1">The BoundSign operation is used by the signer to return a valid BBS signature, including the Prover's BLS secret key as one of signed messages. It works exactly like the regular BBS Sign, but it adds the BlsPk to the value of B. The Signer MUST first validate the correctness of the Prover's Bls PK, using the <a href="#bls-key-pop-verification">BlsKeyPopVerify</a> operation.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.2-2">
<pre>boundBbsSignature = BoundSign(SK, PK, BlsPk, header, messages)

Inputs:

// SK, PK, header and messages, are as in the BBS draft spec.
- BlsPk (REQUIRED), octet string. The Prover's BLS public key.

Parameters:

- bbs_suite_id, ASCII string. The unique ID of the BBS ciphersuite.
- BP_1, the base point of G1, defined by the BLS ciphersuite.

Procedure:

1.  res = KeyValidate(BlsPk)
2.  if res INVALID, return INVALID

//  Bond BBS specific header
3.  header_prime = header || "BBS_BOUND_"

//  Calculate the domain, also including the base point of G1
4.  (Q_1, Q_2, H_1, ..., H_L) = core_create_generators(L+2)
5.  domain = calculate_domain(PK, Q_1, Q_2, (H_1, ..., H_L, BP_1), header)
6.  if domain is INVALID, return INVALID

//  e, s calculation, also including the BlsPk received from the Prover
7.  e_s_octs = serialize((SK, BlsPk, domain, msg_1, ..., msg_L))
8.  if e_s_octs is INVALID, return INVALID
9.  e_s_len = octet_scalar_length * 2
10. e_s_expand = expand_message(e_s_octs, expand_dst, e_s_len)
11. if e_s_expand is INVALID, return INVALID
12. e = hash_to_scalar(e_s_expand[0..(octet_scalar_length - 1)])
13. s = hash_to_scalar(e_s_expand[octet_scalar_length..(e_s_len - 1)])
14. if e or s is INVALID, return INVALID

//  Use the BlsPk to calculate B
15. B = P1 + Q_1 * s + Q_2 * domain + H_1 * msg_1 + ... + H_L * msg_L
16. B = B + BlsPk

17. A = B * (1 / (SK + e))
18. return signature_to_octets(A, e, s)
</pre><a href="#section-3.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="signature-verification">
<section id="section-3.2">
        <h3 id="name-signature-verification">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-signature-verification" class="section-name selfRef">Signature Verification</a>
        </h3>
<p id="section-3.2-1">Bound signature verification is used by the Prover to validate the signature returned from the Signer. The operation is mostly the same as BBSVerify, with the difference that the prover's BLS secret key is included as one of the messages, and that the create_generators used is the one defined in <a href="#create-generators">Create Generators</a>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-2">
<pre>result = BoundVerify(PK, BlsSk, signature, header, messages)

Inputs:

// PK, signature, header, messages are the same as in the BBS draft
- BlsSk (REQUIRED), octet string, the Prover's BLS secret key.

Parameters:

- BP_1, the base point of G1, defined by the BLS ciphersuite.

Procedure:

1. messages.push(BlsSk)
2. header_prime = header || "BBS_BOUND_"
3. result = BbsVerify(PK, signature, header_prime, messages)
4. if result is INVALID, return INVALID
5. return VALID
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-generation">
<section id="section-3.3">
        <h3 id="name-proof-generation">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-proof-generation" class="section-name selfRef">Proof Generation</a>
        </h3>
<p id="section-3.3-1">The BoundProofGen operation, is used by the Prover to create a proof bound to their BLS secret key. The operation has the same Procedure as the normal BBS ProofGen operation, with the difference that the BlsSk of the prover is included as one of (undisclosed) the messages, and that the create_generators used is the one defined in <a href="#create-generators">Create Generators</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>proof = BoundProofGen(PK, signature, BlsSk, header, ph, messages,
                                                     disclosed_indexes)

Inputs:

// PK, signature, header, ph, messages, and disclosed_indexes are the
// same as in the BBS draft spec
- BlsSk (REQUIRED), octet string, the Prover's BLS secret key.

Parameters:

- BP_1, the base point of G1, defined by the BLS ciphersuite.

Procedure:

1. messages.push(BlsSk)
2. header_prime = header || "BBS_BOUND_"
3. proof = BBSProofGen(PK, signature, header_prime, ph, messages,
                                                     disclosed_indexes)
4. if proof is INVALID, return INVALID
5. return proof
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-verification">
<section id="section-3.4">
        <h3 id="name-proof-verification">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-proof-verification" class="section-name selfRef">Proof Verification</a>
        </h3>
<p id="section-3.4-1">The BoundProofVerify operation is used to validate the bound proof. The operation is essentially using the BbsVerify from BBS draft, with the only difference the use of the create_generators procedure defined in <a href="#create-generators">Create Generators</a>). Note: the Preconditions steps are also updated, to apply in the case of Bound BBS signatures.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>result = BoundProofVerify(PK, proof, L, header, ph,
                     disclosed_messages,
                     disclosed_indexes)

Inputs:
// PK, proof, L, header, ph, disclosed_messages, disclosed_indexes the
// same as in the BBS draft spec.

Parameters:
// The same as in the BBS draft spec with one addition
- BP_1, the base point of G1, defined by the BLS ciphersuite.

Definitions:
// The same as in the BBS draft spec

Outputs:
// The same as in the BBS draft spec

Preconditions:
// L was updated to L + 1.
1. for i in (i1, ..., iR), if i &lt; 1 or i &gt; L - 1, return INVALID
2. if length(disclosed_messages) != R, return INVALID

Procedure:

1. header_prime = header || "BBS_BOUND_"
2. result = BbsProofVerify(PK, proof, header_prime, ph,
                                 disclosed_messages, disclosed_indexes)
3. if result is INVALID, return INVALID
4. return VALID
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="utility-operations">
<section id="section-4">
      <h2 id="name-utility-operations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-utility-operations" class="section-name selfRef">Utility Operations</a>
      </h2>
<div id="getblspopmsg">
<section id="section-4.1">
        <h3 id="name-getblspopmsg">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-getblspopmsg" class="section-name selfRef">GetBlsPopMsg</a>
        </h3>
<p id="section-4.1-1">Returns the message that the prover will sign to demonstrate possession of a BLS secret key. The message includes the BBS and BLS ciphersuite identifiers, the audience (aud) of the PoP (i.e., the Issuer's) unique identifier, a domain separation tag (dst), as well as any extra information (like creation date, random nonces etc), the application may require. It is RECOMMENDED to include the BLS PK of the prover, as part of the extra information (extra_info) signed.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>msg = get_bls_pop_msg(bbs_suite_id, bls_suite_id, aud, extra_info, dst)

Inputs:
- bbs_suite_id (REQUIRED), ASCII string. The unique ID of the BBS ciphersuite.
- bls_suite_id (REQUIRED), ASCII string. The unique ID of the BLS ciphersuite.
- aud (REQUIRED), octet string. The unique ID of the Issuer.
- dst (OPTIONAL), octet string. Domain separation tag. If not supplied
                  it defaults to the empty string ("").
- extra_info (OPTIONAL), octet string. Extra information to include to the
                       message. If not supplied, it defaults to the
                       empty string ("").

Outputs:

- msg, octet string or INVALID.

Procedure:

1. aud_len = length(Aud)
2. extra_info_len = length(extra_info)
3. if aud_len &gt; 65535 or extra_info_len &gt; 65535, return INVALID
4. if length(dst) &gt; 255, return INVALID

5. msg_prime = utf8(bbs_suite_id) || utf8(bls_suite_id)
6. msg_prime = msg_prime || utf8("BBS_BLS_POP_MSG_")
7. msg_prime = msg_prime || I2OSP(aud_len, 2) || aud
8. msg = msg_prime || I20SP(extra_info_len, 2) || extra_info || dst
9. return msg
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="create-generators">
<section id="section-4.2">
        <h3 id="name-create-generators">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-create-generators" class="section-name selfRef">Create Generators</a>
        </h3>
<p id="section-4.2-1">An updated create_generators procedure, that also returns the base point of G1 as the last generator. This create_generators operation should be used in place of the one described in <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html#name-generator-point-computation">Section 4.2</a> in the BBS draft, when using the core BBS operations.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>generators = create_generators(count)

Inputs:

- count (REQUIRED), unsigned integer. Number of generators to create.

Outputs:

- generators, an array of count generators.

Procedure:

1. if count &lt; 1, return INVALID
2. generators = core_create_generators(count - 1)
3. if generators is INVALID, return INVALID
4. (generator_1, ..., generator_(count-1)) = generators
5. return (generator_1, ..., generator_(count-1), BP_1)
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="subgroup-checks">
<section id="section-5.1">
        <h3 id="name-subgroup-checks">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-subgroup-checks" class="section-name selfRef">Subgroup Checks</a>
        </h3>
<p id="section-5.1-1">There are 2 relative subgroup checks that need to be performed: First that the BLS KeyPoP is a valid point of G2 and second that the BLS PK is a valid point of G1.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The BLS KeyPoP check is done internally during BlsVerify step of the <a href="#bls-key-pop-verification">BlsKeyPopVerify</a> operation, which calls the <code>signature_subgroup_check</code> utility operation. Although some implementations of BLS signatures don't include that check, it MUST NOT be skipped. If the BLS implementation does not include it, the BBS Signer MUST add it as a pre-computation step in the BlsKeyPopVerify operation. It's also important that this check is performed for the correct subgroup i.e., for G2.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Similarly, the BLS public key of the Prover, MUST be a valid point of G1. This is checked using <code>KeyValidate</code> in the first step of <a href="#bls-key-pop-verification">BlsKeyPopVerify</a>. This step is REQUIRED and must not be skipped. This not only for the BlsVerify operation to be well defined, but also that the public key can be used to bind the BBS signature to the BLS secret key of the Prover. It's also important that this check is performed for the correct subgroup i.e., for G1.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-pop-domain-separation">
<section id="section-5.2">
        <h3 id="name-key-pop-domain-separation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-key-pop-domain-separation" class="section-name selfRef">Key PoP Domain Separation</a>
        </h3>
<p id="section-5.2-1">It is RECOMMENDED that proper domain separation will be used when creating a KeyPoP using the <a href="#bls-secret-key-commitment">BlsKeyPoP</a> operation. A proper dst value includes at least the name of the application and a version number. This is critical when new versions of this draft and the api are released that mitigate issues and vulnerabilities. See Section 3.1 from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> for more details.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-pop-uniqueness">
<section id="section-5.3">
        <h3 id="name-key-pop-uniqueness">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-key-pop-uniqueness" class="section-name selfRef">Key PoP Uniqueness</a>
        </h3>
<p id="section-5.3-1">The BlsSign used to generate the KeyPoP during the <a href="#bls-secret-key-commitment">BlsKeyPoP</a> is deterministic and hence constant on the same inputs. As a result, other mechanisms are needed to guarantee the uniqueness of the KeyPoP returned by that operation. It is RECOMMENDED that the BBS Signer will take steps to validate the uniqueness and freshness of the KeyPoP received from the Prover. Those steps include but are not limited to: inserting a random nonce (supplied by the Signer) or the creation date, as part of the <code>extra_info</code> input field of the <a href="#bls-secret-key-commitment">BlsKeyPoP</a> operation.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-6">
      <h2 id="name-normative-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.irtf-cfrg-bbs-signatures">[I-D.irtf-cfrg-bbs-signatures]</dt>
      <dd>
<span class="refAuthor">Looker, T.</span>, <span class="refAuthor">Kalos, V.</span>, <span class="refAuthor">Whitehead, A.</span>, and <span class="refAuthor">M. Lodder</span>, <span class="refTitle">"The BBS Signature Scheme"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bbs-signatures-02</span>, <time datetime="2023-03-11" class="refDate">11 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-02">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-bls-signature">[I-D.irtf-cfrg-bls-signature]</dt>
    <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Gorbunov, S.</span>, <span class="refAuthor">Wahby, R. S.</span>, <span class="refAuthor">Wee, H.</span>, <span class="refAuthor">Wood, C. A.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"BLS Signatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bls-signature-05</span>, <time datetime="2022-06-16" class="refDate">16 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-05">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7">
      <h2 id="name-informative-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
    <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vasilis Kalos</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vasilis.kalos@mattr.global" class="email">vasilis.kalos@mattr.global</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
